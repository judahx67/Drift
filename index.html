<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Drift. | Regional Pixel Sorting</title>
  <meta name="description" content="Interactive regional pixel sorting">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="style.css">
  <link rel="icon" type="image/png" href="/drift-logo.png">
  <meta property="og:image" content="/drift-logo.png">
</head>

<body>
  <header id="app-header">
    <div class="logo-container">
      <img src="/drift-logo.png" alt="Drift Logo" class="brand-logo">
      <h1>Drift.</h1>
    </div>
    <p class="subtitle">select a region ¬∑ sort pixels ¬∑ export</p>
  </header>

  <main id="app-main">
    <!-- Controls Bar -->
    <section id="controls">
      <!-- File actions -->
      <div class="control-group" id="file-controls">
        <button id="btn-upload" type="button" data-tooltip="Load an image from your device"
          data-tooltip-pos="bottom">Upload Image <span class="kbd-hint">Ctrl+O</span></button>
        <input type="file" id="file-input" accept="image/*" hidden>
        <button id="btn-export" type="button" data-tooltip="Save the current canvas as a PNG" data-tooltip-pos="bottom"
          disabled>Export PNG <span class="kbd-hint">Ctrl+S</span></button>
      </div>

      <div class="separator"></div>

      <!-- Sort Mode -->
      <div class="control-group" id="sort-mode-controls">
        <label class="control-label">Sort By</label>
        <div class="btn-group" id="sort-mode-group">
          <button class="btn-toggle active" data-mode="brightness" data-tooltip="Sort by pixel luminance"
            data-tooltip-pos="bottom">Brightness</button>
          <button class="btn-toggle" data-mode="hue" data-tooltip="Sort by color value (angle)"
            data-tooltip-pos="bottom">Hue</button>
          <button class="btn-toggle" data-mode="saturation" data-tooltip="Sort by color intensity"
            data-tooltip-pos="bottom">Saturation</button>
          <button class="btn-toggle" data-mode="red" data-tooltip="Sort by Red channel"
            data-tooltip-pos="bottom">R</button>
          <button class="btn-toggle" data-mode="green" data-tooltip="Sort by Green channel"
            data-tooltip-pos="bottom">G</button>
          <button class="btn-toggle" data-mode="blue" data-tooltip="Sort by Blue channel"
            data-tooltip-pos="bottom">B</button>
          <button class="btn-toggle" data-mode="gamma" data-tooltip="Sort by perceived brightness"
            data-tooltip-pos="bottom">Gamma</button>
        </div>
      </div>

      <div class="separator"></div>

      <!-- Direction -->
      <div class="control-group" id="direction-controls">
        <label class="control-label">Direction</label>
        <div class="btn-group" id="direction-group">
          <button class="btn-toggle active" data-direction="horizontal" data-tooltip="Sort pixels in rows"
            data-tooltip-pos="bottom">Horizontal</button>
          <button class="btn-toggle" data-direction="vertical" data-tooltip="Sort pixels in columns"
            data-tooltip-pos="bottom">Vertical</button>
        </div>
      </div>

      <div class="separator"></div>

      <!-- Thresholds -->
      <div class="control-group" id="threshold-controls">
        <label class="control-label"
          data-tooltip="Defines the range of values to be sorted. Pixels outside this range are ignored."
          data-tooltip-pos="bottom" data-tooltip-wide>Thresholds</label>
        <div class="slider-row">
          <span class="slider-label">Lower</span>
          <input type="range" id="threshold-lower" min="0" max="255" value="50" class="slider">
          <input type="number" id="threshold-lower-num" min="0" max="255" value="50" class="num-input">
        </div>
        <div class="slider-row">
          <span class="slider-label">Upper</span>
          <input type="range" id="threshold-upper" min="0" max="255" value="200" class="slider">
          <input type="number" id="threshold-upper-num" min="0" max="255" value="200" class="num-input">
        </div>
      </div>

      <div class="separator"></div>

      <!-- Noise -->
      <div class="control-group" id="noise-controls">
        <label class="control-label" data-tooltip="Adds random variation to the threshold boundaries"
          data-tooltip-pos="bottom">Noise</label>
        <div class="slider-row">
          <span class="slider-label">Amount</span>
          <input type="range" id="noise-amount" min="0" max="100" value="0" class="slider">
          <input type="number" id="noise-amount-num" min="0" max="100" value="0" class="num-input">
        </div>
      </div>

      <div class="separator"></div>

      <!-- Filters -->
      <div class="control-group" id="filter-controls">
        <label class="control-label">Filter</label>
        <div class="btn-group" id="filter-group">
          <button class="btn-toggle" data-filter="brightness" data-tooltip="Adjust brightness">Bright</button>
          <button class="btn-toggle" data-filter="contrast" data-tooltip="Adjust contrast">Contrast</button>
          <button class="btn-toggle" data-filter="blur" data-tooltip="Blur image details">Blur</button>
          <button class="btn-toggle" data-filter="sharpen" data-tooltip="Enhance edges and details">Sharpen</button>
          <button class="btn-toggle" data-filter="invert" data-tooltip="Reverse colors">Invert</button>
          <button class="btn-toggle" data-filter="grayscale" data-tooltip="B&W conversion">B&W</button>
        </div>
        <div class="slider-row" id="filter-intensity-row" style="display:none">
          <span class="slider-label" data-tooltip="Current filter strength">Intensity</span>
          <input type="range" id="filter-intensity" min="-100" max="100" value="50" class="slider">
          <input type="number" id="filter-intensity-num" min="-100" max="100" value="50" class="num-input">
        </div>
        <button id="btn-apply-filter" type="button" data-tooltip="Apply the selected filter to history" disabled>Apply
          Filter <span class="kbd-hint">F</span></button>
      </div>

      <div class="separator"></div>

      <!-- Actions -->
      <div class="control-group" id="action-controls">
        <button id="btn-sort" type="button" class="btn-primary"
          data-tooltip="Permanently apply current preview and save to history" disabled>Commit <span
            class="kbd-hint">Enter</span></button>
        <button id="btn-reset" type="button" data-tooltip="Restore selection to its state before sorting"
          disabled>Reset</button>
      </div>
    </section>

    <!-- Canvas Workspace -->
    <section id="workspace">
      <div id="canvas-container">
        <canvas id="canvas"></canvas>
        <div id="selection-overlay" hidden></div>
        <div id="processing-overlay">
          <div class="spinner"></div>
          <span>Sorting pixels‚Ä¶</span>
        </div>
        <div id="drop-zone">
          <p>Drop an image here<br>or click <strong>Upload Image</strong></p>
        </div>
      </div>

      <!-- Selection info -->
      <div id="selection-info" hidden>
        <span id="selection-coords"></span>
        <button id="btn-select-all" type="button" data-tooltip="Select the entire image">Select All</button>
        <button id="btn-clear-selection" type="button" data-tooltip="Remove selection box">Clear Selection</button>
      </div>

      <!-- History Navigation -->
      <div id="history-nav" hidden>
        <button id="btn-history-back" type="button" data-tooltip="Previous iteration" disabled>‚Üê Back <span
            class="kbd-hint">Ctrl+Z</span></button>
        <span id="history-counter">Step 1 / 1</span>
        <button id="btn-history-forward" type="button" data-tooltip="Next iteration" disabled>Forward ‚Üí <span
            class="kbd-hint">Ctrl+Y</span></button>
        <button id="btn-flatten" type="button"
          data-tooltip="Keep current iteration and discard all other history steps">Flatten</button>
      </div>

      <!-- Storage Info -->
      <div id="storage-info" hidden>
        <span id="storage-indicator">üíæ 0 steps ¬∑ ~0 MB</span>
        <button id="btn-clear-history" type="button" data-tooltip="Delete all history and keep current step">Clear
          History</button>
        <button id="btn-export-zip" type="button" data-tooltip="Download all history iterations as a ZIP file">Save All
          as ZIP</button>
      </div>
    </section>
  </main>

  <footer id="app-footer">
    <p>all processing happens in your browser ¬∑ nothing is uploaded</p>
  </footer>

  <script type="module" src="/app.js"></script>
  <div id="toast"></div>
</body>

</html>